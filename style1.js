let products = {
    data: [
        {
            productName: "SDMN Varsity Jacket",
            category: "Jacket",
            price: "6800",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "high",
            image: "images/11.png",
            url: "item_info/item_info1.html",
            tag1: "coat",
            tag2: "jacket"
        },

        {
            productName: "SDMN Varsity Forest",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "Green",
            gender: "Men",
            brand: "high",
            image: "images/21.png",
            url: "item_info/item_info2.html",
            tag1: "coat",
            tag2: "pullover"
        },
        {
            productName: "SDMN Varsity Stone",
            category: "Hoodie",
            price: "6400",
            size: "L",
            color: "White",
            gender: "Men",
            brand: "high",
            image: "images/31.png",
            url: "item_info/item_info3.html",
            tag1: "coat",
            tag2: "pullover"
        },
        {
            productName: "SDMN Varsity Off",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "White",
            gender: "Men",
            brand: "high",
            image: "images/41.png",
            url: "item_info/item_info4.html",
            tag1: "coat",
            tag2: "pullover"
        },
        {
            productName: "SDMN Varsity Sweatshirt",
            category: "Sweatshirt",
            price: "4800",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "medium",
            image: "images/51.png",
            url: "item_info/item_info6.html",
            tag1: "t shirt",
            tag2: "tee"
        },
        {
            productName: "SDMN Varsity Fullshirt",
            category: "Sweatshirt",
            price: "4800",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "medium",
            image: "images/61.png",
            url: "item_info/item_info5.html",
            tag1: "jumper",
            tag2: "fullarm"
        },
        {
            productName: "SDMN Spongebob shirt",
            category: "T-shirt",
            price: "3000",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "low",
            image: "images/71.png",
            url: "item_info/item_info7.html",
            tag1: "t shirt",
            tag2: "tee"
        },
        {
            productName: "XIX Nitro Puffer",
            category: "Jacket",
            price: "7400",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "high",
            image: "images/81.png",
            url: "item_info/item_info8.html",
            tag1: "coat",
            tag2: "jacket"
        },
        {
            productName: "XIX Nitro Hoodie",
            category: "Hoodie",
            price: "4800",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "medium",
            image: "images/91.png",
            url: "item_info/item_info9.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "XIX Nitro Orange Hood",
            category: "Hoodie",
            price: "4800",
            size: "M",
            color: "Orange",
            gender: "Men",
            brand: "medium",
            image: "images/101.png",
            url: "item_info/item_info10.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "XIX Nitro Thunder",
            category: "T-shirt",
            price: "3200",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "low",
            image: "images/111.png",
            url: "item_info/item_info11.html",
            tag1: "polo",
            tag2: "t shirt"
        },
        {
            productName: "SDMN Varsity Melange",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "Grey",
            gender: "Men",
            brand: "high",
            image: "images/121.png",
            url: "item_info/item_info12.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Spongebob Hoodie",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "high",
            image: "images/131.png",
            url: "item_info/item_info13.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Blowing Shirt",
            category: "T-shirt",
            price: "3000",
            size: "M",
            color: "White",
            gender: "Men",
            brand: "low",
            image: "images/141.png",
            url: "item_info/item_info14.html",
            tag1: "tee",
            tag2: "polo"
        },
        {
            productName: "SDMN Carmine Red Shirt",
            category: "T-shirt",
            price: "3200",
            size: "M",
            color: "Red",
            gender: "Men",
            brand: "low",
            image: "images/151.png",
            url: "item_info/item_info15.html",
            tag1: "t shirt",
            tag2: "tee"
        },
        {
            productName: "SDMN Pastel Hoodie",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "Red",
            gender: "Women",
            brand: "high",
            image: "images/161.png",
            url: "item_info/item_info16.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Pink Hoodie",
            category: "Hoodie",
            price: "3900",
            size: "M",
            color: "Pink",
            gender: "Women",
            brand: "low",
            image: "images/171.png",
            url: "item_info/item_info17.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Partition Hoodie",
            category: "Hoodie",
            price: "3900",
            size: "M",
            color: "Green",
            gender: "Men",
            brand: "low",
            image: "images/181.png",
            url: "item_info/item_info18.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Toby Hoodie",
            category: "Hoodie",
            price: "5100",
            size: "M",
            color: "Black",
            gender: "Men",
            brand: "medium",
            image: "images/191.png",
            url: "item_info/item_info19.html",
            tag1: "pullover",
            tag2: "coat"
        },
        {
            productName: "SDMN Soda Sweatshirt",
            category: "Hoodie",
            price: "4800",
            size: "M",
            color: "Orange",
            gender: "Men",
            brand: "medium",
            image: "images/201.png",
            url: "item_info/item_info20.html",
            tag1: "tee",
            tag2: "jumper"
        },
        {
            productName: "SDMN Harry Hoodie",
            category: "Hoodie",
            price: "6400",
            size: "M",
            color: "White",
            gender: "Men",
            brand: "high",
            image: "images/211.png",
            url: "item_info/item_info21.html",
            tag1: "pullover",
            tag2: "coat"
        },
    ],
};
let productCount = 0;
for (let i of products.data) {
    let card = document.createElement("div");
    card.classList.add("card", i.category, "hide");
    let imgContainer = document.createElement("div");
    imgContainer.classList.add("image-container");
    let image = document.createElement("img");
    image.setAttribute("src", i.image);
    card.onclick = function () {
        window.location.href = i.url;
    };

    imgContainer.appendChild(image);
    card.appendChild(imgContainer);
    let container = document.createElement("div");
    container.classList.add("container");
    let name = document.createElement("h5");
    name.classList.add("product-name");
    name.innerText = i.productName.toUpperCase();
    container.appendChild(name);
    let price = document.createElement("h6");
    price.innerText = "Rs" + i.price;
    container.appendChild(price);

    card.appendChild(container);
    card.setAttribute("data-gender", i.gender);
    card.setAttribute("data-color", i.color);
    card.setAttribute("data-size", i.size);
    card.setAttribute("data-brand", i.brand);
    card.setAttribute("data-tag1", i.tag1);
    card.setAttribute("data-tag2", i.tag2);
    card.style.padding = "1em";
    document.getElementById("products").appendChild(card);

}
let searchInput = document.getElementById("search-input");
let searchButton1 = document.getElementById("search");
let count = 0;
searchButton1.addEventListener("click", function () {
    let searchTerm = searchInput.value.trim().toLowerCase();
    count = 0;
    for (let i of products.data) {
        if (i.productName.toLowerCase().includes(searchTerm)) {
            count++;
        }
    }

    console.log(count + " products found");
});

document.getElementById("search").addEventListener("click", () => {
    let searchInput = document.getElementById("search-input").value.toUpperCase();
    let cards = document.querySelectorAll(".card");
    let resultCount = 0;

    cards.forEach((card) => {
        let productName = card.querySelector(".product-name").innerText.toUpperCase();
        let tag1 = card.getAttribute("data-tag1").toUpperCase();
        let tag2 = card.getAttribute("data-tag2").toUpperCase();

        if (productName.includes(searchInput) || tag1.includes(searchInput) || tag2.includes(searchInput)) {
            card.classList.remove("hide");
            resultCount++;
        } else {
            card.classList.add("hide");
        }
    });
});


let checkboxes = document.querySelector('input[type="checkbox"]');
let topwearButton = document.querySelector(".button-value");
checkboxes.addEventListener("click", function () {
    let recommendDiv = document.getElementById("recommend");
    let heading = document.getElementById("heading");
    recommendDiv.innerHTML = "";
    heading.innerHTML = "";
    return;
});
topwearButton.addEventListener("click", function () {
    let recommendDiv = document.getElementById("recommend");
    let heading = document.getElementById("heading");
    recommendDiv.innerHTML = "";
    heading.innerHTML = "";
    return;
});

function getRandomProducts(count) {
    let randomProducts = [];
    let maxIndex = products.data.length - 1;
    let productsCopy = [...products.data];

    for (let i = 0; i < count; i++) {
        let randomIndex = Math.floor(Math.random() * (maxIndex + 1));
        randomProducts.push(productsCopy[randomIndex]);
        productsCopy.splice(randomIndex, 1);
        maxIndex--;
    }

    return randomProducts;
}


// let searchButton = document.getElementById("search");
// searchButton.addEventListener("click", function () {
//     let searchInput = document.getElementById("search-input").value;
//     recommend(searchInput);
// });


function filterProduct(value) {
    let buttons = document.querySelectorAll(".button-value");
    buttons.forEach((button) => {
        if (value.toUpperCase() === button.innerText.toUpperCase()) {
            button.classList.add("active");
        } else {
            button.classList.remove("active");
        }
    });

    let elements = document.querySelectorAll(".card");
    elements.forEach((element) => {
        if (value === "all") {
            element.classList.remove("hide");
        } else {
            if (element.classList.contains(value)) {
                element.classList.remove("hide");
            } else {
                element.classList.add("hide");
            }
        }
    });
}


function filterProducts() {
    const selectedColors = Array.from(document.querySelectorAll('input[name="color"]:checked')).map((checkbox) => checkbox.value);
    const selectedGenders = Array.from(document.querySelectorAll('input[name="gender"]:checked')).map((checkbox) => checkbox.value);
    const selectedBrand = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map((checkbox) => checkbox.value);
    const elements = document.querySelectorAll('.card');
    var resultMessage = document.getElementById('result-message1');
    let count = 0;

    elements.forEach((element) => {
        const productColor = element.getAttribute('data-color');
        const productGender = element.dataset.gender;
        const productdBrand = element.dataset.brand;
        const colorMatch = selectedColors.length === 0 || selectedColors.includes(productColor);
        const genderMatch = selectedGenders.length === 0 || selectedGenders.includes(productGender) || (selectedGenders.includes("Men") && selectedGenders.includes("Women") && productGender === "Both");
        const brandMatch = selectedBrand.length === 0 || selectedBrand.includes(productdBrand) || (selectedBrand.includes("Sidemen") && selectedBrand.includes("Logang") && productdBrand === "Both");
        if (colorMatch && genderMatch && brandMatch) {
            element.classList.remove('hide');
            count++;
        } else {
            element.classList.add('hide');
        }
    });
    let heading = document.getElementById('heading');
    if (count === 0) {
        resultMessage.innerHTML = '';
        heading.innerHTML = "";
    } else {
        // resultMessage.innerHTML = `Showing ${count} matching products.`;
        heading.innerHTML = "";
    }
}
document.querySelectorAll('input[name="color"], input[name="gender"],input[name="brand"]').forEach((checkbox) => {
    checkbox.addEventListener('change', filterProducts);
});

if (window.performance) {
    if (performance.navigation.type == 1) {
        const searchParams = new URLSearchParams(window.location.search);
        searchParams.delete('searchQuery');
        const newUrl = `${window.location.origin}${window.location.pathname}?${searchParams.toString()}`;
        window.location.replace(newUrl);
    }
}


// function recommend(tag) {
//     let recommendDiv = document.getElementById("recommend");
//     recommendDiv.innerHTML = "";

//     let numRecommended = 0;

//     for (let i of products.data) {
//         if (i.tag1 === tag || i.tag2 === tag) {
//             let card = document.createElement("div");
//             card.classList.add("card", i.category);
//             let imgContainer = document.createElement("div");
//             imgContainer.classList.add("image-container");
//             let image = document.createElement("img");
//             image.setAttribute("src", i.image);
//             card.onclick = function () {
//                 window.location.href = i.url;
//             };
//             imgContainer.appendChild(image);
//             card.appendChild(imgContainer);
//             let container = document.createElement("div");
//             container.classList.add("container");
//             let name = document.createElement("h5");
//             name.classList.add("product-name");
//             name.innerText = i.productName.toUpperCase();
//             container.appendChild(name);
//             let price = document.createElement("h6");
//             price.innerText = "$" + i.price;
//             container.appendChild(price);
//             card.appendChild(container);
//             recommendDiv.appendChild(card);
//             card.style.padding = "1em";

//             numRecommended++;
//         }
//     }
//     // if (numRecommended >= 1) {
//     //     let heading = document.getElementById("heading");
//     //     heading.innerText = "Recommended Products";
//     //     heading.classList.add("no-products");
//     //     recommendDiv.classList.remove("no-products");

//     // }
//     // if (numRecommended >= 1) {
//     //     let heading = document.getElementById("heading");
//     //     heading.innerText = "Recommended";
//     //     heading.style.display = "none";
//     //     recommendDiv.style.display = "none";

//     // }
//     // if (numRecommended == 0) {
//     //     let heading = document.getElementById("heading");
//     //     heading.innerText = " ";
//     //     recommendDiv.classList.remove("no-products");
//     // }
//     // if (count === 0) {
//     //     recommendDiv.classList.add("no-products");
//     //     heading.classList.add("no-products");
//     //     heading.innerText = "";
//     // }
//     // else {
//     //     recommendDiv.classList.remove("no-products");
//     //     heading.classList.remove("no-products");
//     //     heading.innerText = " ";
//     // }
//     if (count > 0) {
//         recommendDiv.classList.remove("no-products");
//     }
//     if (numRecommended != 0 && count == 0) {
//         let heading = document.getElementById("heading");
//         heading.innerText = " ";
//         heading.classList.add("no-products");
//         recommendDiv.classList.add("no-products");
//     }
//     if (count === 0 && numRecommended == 0) {
//         let heading = document.getElementById("heading");
//         heading.innerText = "No matching products found. Here are some Recommended products:";
//         recommendDiv.classList.add("no-products");
//         heading.classList.add("no-products");
//         let randomProducts = getRandomProducts(6);
//         for (let i of randomProducts) {
//             let card = document.createElement("div");
//             card.classList.add("card", i.category);
//             let imgContainer = document.createElement("div");
//             imgContainer.classList.add("image-container");
//             let image = document.createElement("img");
//             image.setAttribute("src", i.image);
//             card.onclick = function () {
//                 window.location.href = i.url;
//             };
//             imgContainer.appendChild(image);
//             card.appendChild(imgContainer);
//             let container = document.createElement("div");
//             container.classList.add("container");
//             let name = document.createElement("h5");
//             name.classList.add("product-name");
//             name.innerText = i.productName.toUpperCase();
//             container.appendChild(name);
//             let price = document.createElement("h6");
//             price.innerText = "$" + i.price;
//             container.appendChild(price);
//             card.appendChild(container);
//             recommendDiv.appendChild(card);
//             card.style.padding = "1em";
//         }
//         // recommendDiv.style.position = "relative";
//         // recommendDiv.style.height = "10vh";
//         // recommendDiv.style.bottom = "85vh";
//         heading.style.position = "relative";
//         heading.style.bottom = "78vh";
//     }

// }
